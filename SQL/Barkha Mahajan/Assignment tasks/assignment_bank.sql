CREATE TABLE BRANCH(
BNAME VARCHAR(18) PRIMARY KEY,
CITY VARCHAR(18) NOT NULL
)

CREATE TABLE CUSTOMER(
CNAME VARCHAR(19) PRIMARY KEY,
CITY VARCHAR(18) NOT NULL
)

CREATE TABLE DEPOSIT 
(
ACTNO VARCHAR(5) PRIMARY KEY,
CNAME VARCHAR(19) FOREIGN KEY REFERENCES CUSTOMER(CNAME) NOT NULL,
BNAME VARCHAR(18) FOREIGN KEY REFERENCES BRANCH(BNAME) NOT NULL,
AMOUNT INT NOT NULL,
ADATE DATE NOT NULL
)

CREATE TABLE BORROW(
LOANNO VARCHAR(5) PRIMARY KEY,
CNAME VARCHAR(19) FOREIGN KEY REFERENCES CUSTOMER(CNAME) NOT NULL,
BNAME VARCHAR(18) FOREIGN KEY REFERENCES BRANCH(BNAME) NOT NULL,
AMOUNT INT NOT NULL
)


INSERT INTO BRANCH
VALUES ('VRCE','NAGPUR'),
('AJNI', 'NAGPUR'),
('KAROLBAGH','DELHI'),
('CHANDNI','DELHI'),
('DHARAMPETH','NAGPUR'),
('M.G.ROAD','BANGLORE'),
('ANDHERI','MUMBAI'),
('VIRAR','MUMBAI'),
('NEHRU PLACE','DELHI'),
('POWAI','MUMBAI')


INSERT INTO CUSTOMER
VALUES ('ANIL', 'KOLKATA'),
('SUNIL', 'DELHI'),
('MEHUL', 'BARODA'),
('MANDAR', 'PATNA'),
('MADHURI', 'NAGPUR'),
('PRAMOD', 'NAGPUR'),
('SANDIP', 'SURAT'),
('SHIVANI', 'MUMBAI'),
('KRANTI', 'MUMBAI'),
('NAREN', 'MUMBAI')


INSERT INTO DEPOSIT
VALUES ('100','ANIL', 'VRCE', 1000, '1995-03-1'),
 ('101','SUNIL', 'AJNI', 5000, '1996-01-4'),
 ('102','MEHUL', 'KAROLBAGH', 3500, '1995-11-17'),
 ('104','MADHURI', 'CHANDNI', 1200, '1995-12-17'),
 ('105','PRAMOD', 'M.G.ROAD', 3000, '1996-03-27'),
 ('106','SANDIP', 'ANDHERI', 2000, '1996-03-31'),
 ('107','SHIVANI', 'VIRAR', 1000, '1995-09-5'),
 ('108','KRANTI', 'NEHRU PLACE', 5000, '1995-07-2'),
 ('109', 'NAREN', 'POWAI', 7000,'1995-08-10')

 INSERT INTO BORROW
 VALUES ('201', 'ANIL', 'VRCE',1000),
 ('206', 'MEHUL', 'AJNI',5000),
 ('311', 'SUNIL', 'DHARAMPETH',3000),
 ('321', 'MADHURI', 'ANDHERI',2000),
 ('375', 'PRAMOD', 'VIRAR',8000),
 ('481', 'KRANTI', 'NEHRU PLACE',3000)
 
 
 --Q1

 SELECT CNAME FROM DEPOSIT 
 WHERE BNAME IN (SELECT BNAME FROM BRANCH WHERE CITY=(
 SELECT CITY FROM BRANCH WHERE BNAME=(SELECT BNAME FROM DEPOSIT WHERE CNAME='SUNIL')))

 --Q2

 SELECT CNAME FROM DEPOSIT 
 WHERE BNAME = (SELECT BNAME FROM DEPOSIT WHERE CNAME='SUNIL') OR BNAME = (SELECT BNAME FROM BORROW WHERE CNAME='SUNIL')

 --Q3
 
 
(SELECT * INTO TMP FROM (SELECT COUNT(B.CITY) [DEPOSIT_COUNT],CITY FROM BRANCH B JOIN DEPOSIT D ON D.BNAME=B.BNAME GROUP BY B.CITY)abc)

SELECT * FROM TMP ORDER BY DEPOSIT_COUNT DESC

SELECT CITY FROM TMP WHERE DEPOSIT_COUNT = (SELECT MAX(DEPOSIT_COUNT) FROM TMP))

 
--Q4

SELECT D.CNAME FROM DEPOSIT D JOIN BORROW B 
ON D.CNAME=B.CNAME
WHERE D.AMOUNT>1000 AND B.AMOUNT>2000

--Q5

SELECT C.CNAME FROM CUSTOMER C JOIN DEPOSIT D ON C.CNAME=D.CNAME 
JOIN BRANCH B ON B.BNAME=D.BNAME
WHERE C.CITY='NAGPUR' AND B.CITY IN ('DELHI', 'MUMBAI')

--Q6
--LIVE IN SAME CITY AS THEIR BRANH

SELECT COUNT(C.CNAME) FROM CUSTOMER C JOIN DEPOSIT D
ON C.CNAME= D.CNAME JOIN BRANCH B
ON B.BNAME=D.BNAME
WHERE C.CITY=B.CITY

--HAVE BRANCH IN THEIR CITY

SELECT DISTINCT C.CNAME FROM CUSTOMER C JOIN BRANCH B 
ON C.CITY=B.CITY
